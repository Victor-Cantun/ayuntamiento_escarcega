{% extends "layouts/blank.html" %}
{% load static %}
{%block page_title%}
<!--breadcrumb-->
<nav class="flex" aria-label="Breadcrumb">
    <ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse">
        <li class="inline-flex items-center">
            <a href="#" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white">
            <svg class="w-3 h-3 me-2.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                <path d="M10.464 8.746c.227-.18.497-.311.786-.394v2.795a2.252 2.252 0 0 1-.786-.393c-.394-.313-.546-.681-.546-1.004 0-.323.152-.691.546-1.004ZM12.75 15.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991 0 .305-.152.671-.579.991a2.534 2.534 0 0 1-.921.42Z" />
                <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v.816a3.836 3.836 0 0 0-1.72.756c-.712.566-1.112 1.35-1.112 2.178 0 .829.4 1.612 1.113 2.178.502.4 1.102.647 1.719.756v2.978a2.536 2.536 0 0 1-.921-.421l-.879-.66a.75.75 0 0 0-.9 1.2l.879.66c.533.4 1.169.645 1.821.75V18a.75.75 0 0 0 1.5 0v-.81a4.124 4.124 0 0 0 1.821-.749c.745-.559 1.179-1.344 1.179-2.191 0-.847-.434-1.632-1.179-2.191a4.122 4.122 0 0 0-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75 0 0 0 .933-1.175l-.415-.33a3.836 3.836 0 0 0-1.719-.755V6Z" clip-rule="evenodd" />
            </svg> 
            Tesorer√≠a
            </a>
        </li>
        <li>
            <div class="flex items-center">
            <svg class="rtl:rotate-180 w-3 h-3 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
            </svg>
            <a href="#" class="ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white">Ingresos</a>
            </div>
        </li>
        <li>
            <div class="flex items-center">
            <svg class="rtl:rotate-180 w-3 h-3 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
            </svg>
            <a href="#" class="ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white">Pagos</a>
            </div>
        </li>               
    </ol>
</nav>
<!--breadcrumb-->
{%endblock%}
{% block content %}
<div class="">
    <h3 id="title-view" class="uppercase flex justify-between w-full text-xl font-semibold text-white dark:text-white bg-rojo px-6 py-2 border radius rounded-t-lg" >
        Nuevo pago {%if caja_activa %} <span>caja activa: {{caja_activa}}</span> {%endif%}
    </h3>
    <div id="content_view" >
        <div class="w-full p-1 flex  bg-white border border-gray-200 rounded-lg shadow my-2">
            {% include 'admin/income/payment/customer_search.html' %}
        </div>
        <div id="content" >
        </div>
    </div>
</div>
<!-- STATIC MODAL-->
<div id="StaticModal" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative p-4 w-full max-w-2xl max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
            <!-- Modal header -->
            <div class="bg-rojo flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
                <h3 class="text-xl font-semibold text-white">
                    Iniciar caja
                </h3>
            </div>
            <!-- Modal body -->
            <div class="p-4 md:p-5 space-y-4">
                <form class="max-w-sm mx-auto" hx-post="{% url "income:cash_register_start"  %}" hx-target="#ResultCashRegister" hx-swap="innerHTML">
                    {% csrf_token %}
                    <label for="cajas" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">CAJA:</label>
                    <select required name="cash_register" id="cajas" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                        <option value="" >Selecciona una caja para cobrar</option>
                        {% for item in cajas_disponibles %}
                            <option value="{{item.id}}">{{item}}</option>
                        {% endfor %}
                    </select>
                    <hr class="h-px my-2 bg-gray-200 border-0 dark:bg-gray-700">
                    <div class="space-x-3 justify-end flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600 ">
                        <a href="{% url "home" %}" class="cursor-pointer py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
                            Cancelar
                        </a>
                        <button  type="submit" class="focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5  dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">
                            <i class="fas fa-cash-register pr-1"></i> Iniciar caja <span class="spinner-border htmx-indicator" role="status" aria-hidden="true"></span>
                        </button>                
                    </div> 
                </form>
                <div id="ResultCashRegister">
                </div>
            </div>
            <!-- Modal footer -->
            <div class="flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600">
            </div>
        </div>
    </div>
</div>
<!-- STATIC MODAL-->
<script>
    function getModalStatic() {
        const modalEstatic = document.getElementById("StaticModal");
        return new Modal(modalEstatic, {
            placement: 'center',
            backdrop: 'static',
            backdropClasses:'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',
        });
    }
    function CloseStaticModal() {
        getModalStatic().hide();
    }   
    function OpenStaticModal() {
        getModalStatic().show();
    }
</script>

{% if not caja_activa %}
    <script>
        window.addEventListener("load", (event) => {
            OpenStaticModal();
        });
    </script>
    <script>
        function ReloadPage(){ location.reload();}
        //document.body.addEventListener("ReloadPage", function() {
        //    windows.location.reload();
        //});
    </script>
    <script>

        function CloseReload(){
            CloseStaticModal();
            ReloadPage();
        }
    
    </script>
{% endif %}

{% endblock %}
